# VCR0040: GetValueOrThrow defeats Result pattern

| Property    | Value                          |
|-------------|--------------------------------|
| **Rule ID** | VCR0040                        |
| **Category**| Usage                          |
| **Severity**| Info                           |
| **Enabled** | Yes                            |

## Description

`GetValueOrThrow` converts a `Result` failure back into an exception, which defeats the purpose of using the Result pattern. Prefer `Match`, `Bind`, or `Map` for composable error handling that preserves the railway-oriented flow.

## Examples

### Flagged code

```csharp
// VCR0040: Consider using Match instead of GetValueOrThrow
var user = GetUser(id).GetValueOrThrow();
var order = GetOrder(user.Id).GetValueOrThrow();
```

### Recommended alternatives

```csharp
// Option 1: Chain with Bind (keeps everything in Result track)
var result = GetUser(id)
    .Bind(user => GetOrder(user.Id));

// Option 2: Match at the boundary (e.g., controller)
return GetUser(id).Match(
    user => Ok(user),
    error => Problem(error.Message));

// Option 3: Map for simple transformations
var name = GetUser(id).Map(user => user.Name);
```

## When GetValueOrThrow is acceptable

- **Application boundary** — top-level code where exceptions are handled (e.g., console app `Main`)
- **Test code** — where assertion failures are expected
- **Migration** — transitioning from exception-based to Result-based code incrementally

## When to suppress

```editorconfig
# .editorconfig — suppress in test projects
[*Tests/**/*.cs]
dotnet_diagnostic.VCR0040.severity = none

# Or upgrade for stricter enforcement
[*.cs]
dotnet_diagnostic.VCR0040.severity = warning
```

## See also

- [VCR0020 — Result value accessed without success check](VCR0020.md)
- [VCR0030 — Nested Result detected](VCR0030.md)
- [Best Practices](../best-practices.md)
